
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python Library for Fairness-Aware Ranking Data Generation, Evaluation, and Re-Ranking.">
      
      
      
      
        <link rel="prev" href="../metrics/">
      
      
        <link rel="next" href="../examples/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.21">
    
    
      
        <title>Rankers - FairRankTune User Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Rankers - FairRankTune User Guide" >
      
        <meta  property="og:description"  content="A Python Library for Fairness-Aware Ranking Data Generation, Evaluation, and Re-Ranking." >
      
        <meta  property="og:image"  content="./assets/images/social/rankers.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="None" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Rankers - FairRankTune User Guide" >
      
        <meta  name="twitter:description"  content="A Python Library for Fairness-Aware Ranking Data Generation, Evaluation, and Re-Ranking." >
      
        <meta  name="twitter:image"  content="./assets/images/social/rankers.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="amber" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rankers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="FairRankTune User Guide" class="md-header__button md-logo" aria-label="FairRankTune User Guide" data-md-component="logo">
      
  <img src="../assets/FairRankTune_blank_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FairRankTune User Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Rankers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="amber" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="lime" data-md-color-accent="lightblue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="FairRankTune User Guide" class="md-nav__button md-logo" aria-label="FairRankTune User Guide" data-md-component="logo">
      
  <img src="../assets/FairRankTune_blank_logo.png" alt="logo">

    </a>
    FairRankTune User Guide
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ranktune/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RankTune
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metrics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Rankers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Rankers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fair-ranking-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Fair Ranking Algorithms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-fair-ranking-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Fair Ranking Algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Supported Fair Ranking Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#epsilon-greedy-re-ranker" class="md-nav__link">
    <span class="md-ellipsis">
      Epsilon-Greedy Re-Ranker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detconstsort-re-ranker" class="md-nav__link">
    <span class="md-ellipsis">
      DetConstSort Re-Ranker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing-fair-ranking-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Contributing Fair Ranking Algorithms
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fair-ranking-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Fair Ranking Algorithms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-fair-ranking-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Fair Ranking Algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Supported Fair Ranking Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#epsilon-greedy-re-ranker" class="md-nav__link">
    <span class="md-ellipsis">
      Epsilon-Greedy Re-Ranker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detconstsort-re-ranker" class="md-nav__link">
    <span class="md-ellipsis">
      DetConstSort Re-Ranker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing-fair-ranking-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Contributing Fair Ranking Algorithms
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="rankers">Rankers</h1>
<h2 id="fair-ranking-algorithms">Fair Ranking Algorithms</h2>
<p><code>FairRankTune</code> provides <a href="#supported-fair-ranking-algorithms">fair ranking algorithms</a> in the <code>Rankers</code> module. These fair ranking algorithms can be used to re-rank a given ranking with the objective of making the resulting ranking fair. </p>
<h2 id="supported-fair-ranking-algorithms">Supported Fair Ranking Algorithms</h2>
<h3 id="epsilon-greedy-re-ranker">Epsilon-Greedy Re-Ranker</h3>
<p>Epsilon-Greedy takes as input a ranking and repeatedly swaps pairs of items so that each item has probability <span class="arithmatex">\(\epsilon\)</span> (<code>epsilon</code>) of swapping with a random item below it. It does not require a specific notion of fairness or prior knowledge of group distributions. It does use random swapping, thus it is recommended to set a random seed for reproducibility. To learn more see <a href="https://doi.org/10.1609/aaai.v36i11.21445">Feng et al.</a> where it was introduced to improve group fairness.</p>
<p>Usage:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">FairRankTune</span> <span class="k">as</span> <span class="nn">frt</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span> <span class="nn">FairRankTune</span> <span class="kn">import</span> <span class="n">RankTune</span><span class="p">,</span> <span class="n">Metrics</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1">#Generate a biased (phi = 0) ranking of 1000 items, with two groups of 100 and 900 items each.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">group_proportions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">])</span> <span class="c1">#Array of group proportions</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">num_items</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1">#1000 items to be in the generated ranking</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">phi</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#Biased ranking</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">r_cnt</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#Generate 1 ranking</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">ranking_df</span><span class="p">,</span> <span class="n">item_group_dict</span><span class="p">,</span> <span class="n">scores_df</span> <span class="o">=</span> <span class="n">frt</span><span class="o">.</span><span class="n">RankTune</span><span class="o">.</span><span class="n">ScoredGenFromGroups</span><span class="p">(</span><span class="n">group_proportions</span><span class="p">,</span>  <span class="n">num_items</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">r_cnt</span><span class="p">,</span> <span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="c1">#Calculate EXP with a MinMaxRatio</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">EXP_minmax</span><span class="p">,</span> <span class="n">avg_exposures_minmax</span> <span class="o">=</span> <span class="n">frt</span><span class="o">.</span><span class="n">Metrics</span><span class="o">.</span><span class="n">EXP</span><span class="p">(</span><span class="n">ranking_df</span><span class="p">,</span> <span class="n">item_group_dict</span><span class="p">,</span> <span class="s1">&#39;MinMaxRatio&#39;</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EXP before Epsilon-Greedy: &quot;</span><span class="p">,</span> <span class="n">EXP_minmax</span><span class="p">,</span> <span class="s2">&quot;avg_exposures before Epsilon-Greedy: &quot;</span><span class="p">,</span> <span class="n">avg_exposures_minmax</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c1">#Rerank using Epsilon-Greedy</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">seed</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#For reproducibility</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">.6</span> 
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">reranking_df</span><span class="p">,</span> <span class="n">item_group_d</span><span class="p">,</span> <span class="n">reranking_scores</span> <span class="o">=</span> <span class="n">frt</span><span class="o">.</span><span class="n">Rankers</span><span class="o">.</span><span class="n">EPSILONGREEDY</span><span class="p">(</span><span class="n">ranking_df</span><span class="p">,</span> <span class="n">item_group_dict</span><span class="p">,</span> <span class="n">scores_df</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="c1">#Calculate EXP with a MinMaxRatio post Epsilon-Greedy</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="n">EXP</span><span class="p">,</span> <span class="n">avg_exposures</span><span class="o">=</span> <span class="n">frt</span><span class="o">.</span><span class="n">Metrics</span><span class="o">.</span><span class="n">EXP</span><span class="p">(</span><span class="n">reranking_df</span><span class="p">,</span> <span class="n">item_group_d</span><span class="p">,</span> <span class="s1">&#39;MinMaxRatio&#39;</span><span class="p">)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EXP after Epsilon-Greedy: &quot;</span><span class="p">,</span> <span class="n">EXP</span><span class="p">,</span> <span class="s2">&quot;avg_exposures after Epsilon-Greedy: &quot;</span><span class="p">,</span> <span class="n">avg_exposures</span><span class="p">)</span>
</code></pre></div></p>
<p>Output:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">EXP</span> <span class="n">before</span> <span class="n">Epsilon</span><span class="o">-</span><span class="n">Greedy</span><span class="p">:</span>  <span class="mf">0.5420744267551784</span> <span class="n">avg_exposures</span> <span class="n">before</span> <span class="n">Epsilon</span><span class="o">-</span><span class="n">Greedy</span><span class="p">:</span>  <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">0.2093867087428094</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">0.11350318011191189</span><span class="p">}</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">EXP</span> <span class="n">after</span> <span class="n">Epsilon</span><span class="o">-</span><span class="n">Greedy</span><span class="p">:</span>  <span class="mf">0.7689042373241246</span> <span class="n">avg_exposures</span> <span class="n">after</span> <span class="n">Epsilon</span><span class="o">-</span><span class="n">Greedy</span><span class="p">:</span>  <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">0.15541589156986096</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">0.1194999375755728</span><span class="p">}</span>
</code></pre></div>
<code>epsilon</code> must be between <span class="arithmatex">\([0,1]\)</span> and a <code>seed</code> is passed for reproducibility.</p>
<p>Citation:</p>
<details>
  <summary>BibTeX</summary>

<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nc">@article</span><span class="p">{</span><span class="nl">Feng_Shah_2022</span><span class="p">,</span><span class="w"> </span><span class="na">title</span><span class="p">=</span><span class="s">{Has CEO Gender Bias Really Been Fixed? Adversarial Attacking and Improving Gender Fairness in Image Search}</span><span class="p">,</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="na">volume</span><span class="p">=</span><span class="s">{36}</span><span class="p">,</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="na">url</span><span class="p">=</span><span class="s">{https://ojs.aaai.org/index.php/AAAI/article/view/21445}</span><span class="p">,</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="na">DOI</span><span class="p">=</span><span class="s">{10.1609/aaai.v36i11.21445}</span><span class="p">,</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="na">number</span><span class="p">=</span><span class="s">{11}</span><span class="p">,</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="na">journal</span><span class="p">=</span><span class="s">{Proceedings of the AAAI Conference on Artificial Intelligence}</span><span class="p">,</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="na">author</span><span class="p">=</span><span class="s">{Feng, Yunhe and Shah, Chirag}</span><span class="p">,</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="na">year</span><span class="p">=</span><span class="s">{2022}</span><span class="p">,</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="na">month</span><span class="p">=</span><span class="s">{Jun.}</span><span class="p">,</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w"> </span><span class="na">pages</span><span class="p">=</span><span class="s">{11882-11890}</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
</details>

<h3 id="detconstsort-re-ranker">DetConstSort Re-Ranker</h3>
<p>DetConstSort takes as input a given ranking, and re-ranks items in it to create a top-k fair ranking. Fairness is achieved by setting the <code>distribution</code> dictionary.  In <code>distribution</code> the keys are group identifiers and the value is the desired group proportion. For any particular position k and for any group <code>g</code>, DetConstSort ensures that group occurs <span class="arithmatex">\(\lfloor\)</span> <code>distribution[g]</code> <span class="arithmatex">\(*k \rfloor\)</span> in the resulting ranking. DetConstSort algorithm also tries improve the utility of the ranking by ensuring that items with better scores are placed higher in the ranking so long as the ranking satisfies the feasibility criteria. To learn more see <a href="https://dl.acm.org/doi/10.1145/3292500.3330691">Geyik et al.</a>.</p>
<p>Usage:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span> <span class="nn">FairRankTune</span> <span class="k">as</span> <span class="nn">frt</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="kn">from</span> <span class="nn">FairRankTune</span> <span class="kn">import</span> <span class="n">RankTune</span><span class="p">,</span> <span class="n">Metrics</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c1">#Generate a biased (phi = 0) ranking of 1000 items, with two groups of 100 and 900 items each.</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="n">seed</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="n">ranking_df</span><span class="p">,</span> <span class="n">item_group_dict</span><span class="p">,</span> <span class="n">scores_df</span> <span class="o">=</span> <span class="n">frt</span><span class="o">.</span><span class="n">RankTune</span><span class="o">.</span><span class="n">ScoredGenFromGroups</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">]),</span>  <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="c1">#Calculate EXP with a MinMaxRatio</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="n">EXP_minmax</span><span class="p">,</span> <span class="n">avg_exposures_minmax</span> <span class="o">=</span> <span class="n">frt</span><span class="o">.</span><span class="n">Metrics</span><span class="o">.</span><span class="n">EXP</span><span class="p">(</span><span class="n">ranking_df</span><span class="p">,</span> <span class="n">item_group_dict</span><span class="p">,</span> <span class="s1">&#39;MinMaxRatio&#39;</span><span class="p">)</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EXP before DetConstSort: &quot;</span><span class="p">,</span> <span class="n">EXP_minmax</span><span class="p">,</span> <span class="s2">&quot;avg_exposures before DetConstSort: &quot;</span><span class="p">,</span> <span class="n">avg_exposures_minmax</span><span class="p">)</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="c1">#Rerank using DetConstSort</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="n">distribution</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.9</span><span class="p">]))</span> <span class="c1">#set distribution for statistical parity</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="n">k</span> <span class="o">=</span> <span class="mi">800</span> <span class="c1">#only ranking 800 items of the provided 1000 </span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="n">reranking_df</span><span class="p">,</span> <span class="n">item_group_d</span><span class="p">,</span> <span class="n">reranking_scores</span> <span class="o">=</span> <span class="n">frt</span><span class="o">.</span><span class="n">Rankers</span><span class="o">.</span><span class="n">DETCONSTSORT</span><span class="p">(</span><span class="n">ranking_df</span><span class="p">,</span> <span class="n">item_group_dict</span><span class="p">,</span> <span class="n">scores_df</span><span class="p">,</span> <span class="n">distribution</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="c1">#Calculate EXP with a MinMaxRatio post DetConstSort</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="n">EXP</span><span class="p">,</span> <span class="n">avg_exposures</span><span class="o">=</span> <span class="n">frt</span><span class="o">.</span><span class="n">Metrics</span><span class="o">.</span><span class="n">EXP</span><span class="p">(</span><span class="n">reranking_df</span><span class="p">,</span> <span class="n">item_group_d</span><span class="p">,</span> <span class="s1">&#39;MinMaxRatio&#39;</span><span class="p">)</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EXP after DetConstSort: &quot;</span><span class="p">,</span> <span class="n">EXP</span><span class="p">,</span> <span class="s2">&quot;avg_exposures after DetConstSort: &quot;</span><span class="p">,</span> <span class="n">avg_exposures</span><span class="p">)</span>
</code></pre></div></p>
<p>Output:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">EXP</span> <span class="n">before</span> <span class="n">DetConstSort</span><span class="p">:</span>  <span class="mf">0.5420744267551784</span> <span class="n">avg_exposures</span> <span class="n">before</span> <span class="n">DetConstSort</span><span class="p">:</span>  <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">0.2093867087428094</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">0.11350318011191189</span><span class="p">}</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">EXP</span> <span class="n">after</span> <span class="n">DetConstSort</span><span class="p">:</span>  <span class="mf">0.9738302276209081</span> <span class="n">avg_exposures</span> <span class="n">after</span> <span class="n">DetConstSort</span><span class="p">:</span>  <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">0.12535449974404395</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">0.12872315542133886</span><span class="p">}</span>
</code></pre></div></p>
<p>Citation:</p>
<details>
  <summary>BibTeX</summary>

<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nc">@article</span><span class="p">{</span><span class="nl">Feng_Shah_2022</span><span class="p">,</span><span class="w"> </span><span class="na">title</span><span class="p">=</span><span class="s">{Has CEO Gender Bias Really Been Fixed? Adversarial Attacking and Improving Gender Fairness in Image Search}</span><span class="p">,</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="na">volume</span><span class="p">=</span><span class="s">{36}</span><span class="p">,</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="na">url</span><span class="p">=</span><span class="s">{https://ojs.aaai.org/index.php/AAAI/article/view/21445}</span><span class="p">,</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="na">DOI</span><span class="p">=</span><span class="s">{10.1609/aaai.v36i11.21445}</span><span class="p">,</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="na">number</span><span class="p">=</span><span class="s">{11}</span><span class="p">,</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="na">journal</span><span class="p">=</span><span class="s">{Proceedings of the AAAI Conference on Artificial Intelligence}</span><span class="p">,</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="na">author</span><span class="p">=</span><span class="s">{Feng, Yunhe and Shah, Chirag}</span><span class="p">,</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="na">year</span><span class="p">=</span><span class="s">{2022}</span><span class="p">,</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="na">month</span><span class="p">=</span><span class="s">{Jun.}</span><span class="p">,</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w"> </span><span class="na">pages</span><span class="p">=</span><span class="s">{11882-11890}</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
</details>

<h2 id="contributing-fair-ranking-algorithms">Contributing Fair Ranking Algorithms</h2>
<p>We believe in open-source community driven software. Please <a href="mailto:kathleen.cachel@gmail.com?subject=[GitHub]%20fairranktune">reach out</a> to expand the <code>FairRankTune</code> algorithm offerings. </p>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Kcachel" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.top", "navigation.indexes", "toc.follow", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.a7c05c9e.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>